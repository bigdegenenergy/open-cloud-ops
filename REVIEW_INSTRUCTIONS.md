# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```json
{
  "review": {
    "summary": "The PR introduces the Cerebra MVP and a comprehensive AI agent configuration. While the feature set is extensive, there are critical issues regarding dependency integrity (hallucinated future versions in package-lock.json), security defaults (optional admin authentication), and potential correctness bugs in the proxy streaming logic. The extensive agent configuration also introduces security risks regarding arbitrary command execution and SSRF that need mitigation.",
    "decision": "REQUEST_CHANGES"
  },
  "issues": [
    {
      "id": 1,
      "severity": "critical",
      "file": "dashboard/package.json",
      "line": 0,
      "title": "Non-existent/Hallucinated Dependency Versions",
      "description": "The `package.json` and `package-lock.json` reference versions that do not currently exist on public registries (e.g., `react@19.2`, `vite@7.3`, `tailwind@4.1`). While the PR description suggests a '2026' context, merging this into a real repository today will break builds (`npm install` will fail).",
      "suggestion": "Downgrade dependencies to currently stable or valid beta/rc versions (e.g., React 18.x or 19.0.0-rc, Vite 5.x/6.x)."
    },
    {
      "id": 2,
      "severity": "important",
      "file": "cerebra/internal/config/config.go",
      "line": 0,
      "title": "Insecure Admin Auth Default",
      "description": "If `CEREBRA_ADMIN_API_KEY` is not set, the configuration appears to default to empty, effectively disabling authentication for sensitive `/api/v1` management endpoints. Administrative interfaces should fail-secure (deny access) if authentication is not configured.",
      "suggestion": "Modify `Load()` or the middleware to panic or block requests if `AdminAPIKey` is empty, or require the environment variable to be set for the server to start."
    },
    {
      "id": 3,
      "severity": "important",
      "file": "cerebra/internal/proxy/handler.go",
      "line": 0,
      "title": "Potential Data Loss in Streaming Response",
      "description": "The streaming logic resets the accumulation buffer when it reaches 1MB. If the upstream provider sends token usage metadata (e.g., OpenAI's `stream_options: {include_usage: true}`) in the final chunk of a stream that exceeds 1MB, the buffer reset may discard the context needed to parse this usage, leading to under-reported costs.",
      "suggestion": "Implement a rolling buffer or a stream-aware parser that can extract usage metadata without retaining the entire response history, or ensure the final usage chunk is processed independently of the content buffer."
    },
    {
      "id": 4,
      "severity": "important",
      "file": ".github/workflows/claude.yml",
      "line": 0,
      "title": "SSRF Risk via MCP Fetch",
      "description": "The workflow enables `anthropics/mcp-server-fetch` for the AI agent. This allows the agent to make arbitrary HTTP requests from the GitHub Runner environment. A malicious prompt (e.g., via a PR comment) could exploit this to scan internal networks or exfiltrate secrets available to the runner.",
      "suggestion": "Disable the `fetch` MCP server or configure it with a strict allowlist of domains required for the agent's operation."
    },
    {
      "id": 5,
      "severity": "suggestion",
      "file": "cerebra/internal/budget/enforcer.go",
      "line": 0,
      "title": "Unpredictable Budget Cycles",
      "description": "Budgets are implemented using a Redis key with a 30-day TTL. This creates rolling, independent billing cycles for each budget entity based on when the key was first created, rather than a predictable calendar-month cycle. This makes financial reporting and reset alignment difficult.",
      "suggestion": "Use deterministic time buckets for keys (e.g., `budget:{entity_id}:{YYYY-MM}`) to align budgets with standard billing periods."
    }
  ]
}
```